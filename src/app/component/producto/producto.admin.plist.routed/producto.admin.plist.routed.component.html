<div class="container-fluid mt-5">
  <div class="row">
    <div class="col-12">
      <h2 class="mb-4 text-center">
        <i class="bi bi-list"></i> Lista de Productos
      </h2>

      <div class="mb-4 d-flex justify-content-center align-items-center">
        <input
          type="text"
          class="form-control w-50"
          placeholder="Buscar"
          (keyup)="filter($event)"
          [(ngModel)]="strFiltro"
        />
      </div>

      <div class="d-flex justify-content-between">
        @if (strFiltro.length>0) {
        <h5 class="text-muted">
          Filtrado por: <span class="text-danger">{{ strFiltro }}</span>
        </h5>
        } @else{
        <h5 class="text-muted">Sin filtrar</h5>
        }
        <h5 class="text-muted">
          Mostrando {{ oPage?.numberOfElements | number : "1.0-0" }} de
          {{ oPage?.totalElements | number : "1.0-0" }}
        </h5>
      </div>

      <div class="table-responsive">
        <table class="table table-striped table-bordered align-middle text-center">
          <thead class="table-success text-white bg-success">
            <tr>
              <th>ID</th>
              <th>Descripción</th>
              <th>Descripción TIC</th>
              <th>Departamento</th>
              <th>Familia</th>
              <th>Subfamilia</th>
              <th>Marca</th>
              <th>Unidad de Medida</th>
              <th>Cantidad</th>
              <th>Centralizado</th>
              <th>Apeso</th>
              <th>Unidad Caja</th>
              <th>Unidad Servicio</th>
              <th>PK</th>
              <th>Cajas Capa</th>
              <th>Cajas Palet</th>
              <th>Proveedor</th>
              <th>Referencia Proveedor</th>
              <th>EAN</th>
              <th>EAN C</th>
              <th>EAN P</th>
              <th>Largo</th>
              <th>Ancho</th>
              <th>Alto</th>
              <th>Peso</th>
              <th>Días Caducidad</th>
              <th>ARA CEN</th>
              <th>IVA</th>
              <th>Precio Venta</th>
              <th>PVP HOM</th>
              <th>PVP AND</th>
              <th>PVP CAT</th>
              <th>Precio Tarifa</th>
              <th>PRO FAC</th>
              <th>Precio Neto</th>
              <th>PRO FFAC</th>
              <th>PRO NETON</th>
              <th>ART MKD</th>
              <th>Articulo Sustituido</th>
              <th>Insertado por</th>
              <th>Actualizado por</th>
              <th>Status</th>
              <th>Observaciones</th>
              <th>Partida Arancelaria</th>
              <th>PVP MEL</th>
              <th>País Origen</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let producto of oPage?.content" class="clickable-row" (click)="edit(producto)"  style="cursor: pointer;">
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.id }">{{ producto.id || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.descripcion }">{{ producto.descripcion || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.descripcionTic }">{{ producto.descripcionTic || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.departamento }">{{ producto.departamento || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.familia }">{{ producto.familia || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.subfamilia }">{{ producto.subfamilia || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.marca }">{{ producto.marca || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.unidadDeMedida }">{{ producto.unidadDeMedida || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.cantidad }">{{ producto.cantidad || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.centralizado }">{{ producto.centralizado || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.apeso }">{{ producto.apeso || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.unidadDeCaja }">{{ producto.unidadDeCaja || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.unidadDeServicio }">{{ producto.unidadDeServicio || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.pk }">{{ producto.pk || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.cajasCapa }">{{ producto.cajasCapa || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.cajasPalet }">{{ producto.cajasPalet || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.proveedor }">{{ producto.proveedor || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.referenciaProveedor }">{{ producto.referenciaProveedor || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.ean }">{{ producto.ean || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.ean_c }">{{ producto.ean_c || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.ean_p }">{{ producto.ean_p || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.largo }">{{ producto.largo || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.ancho }">{{ producto.ancho || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.alto }">{{ producto.alto || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.peso }">{{ producto.peso || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.diasCaducidad }">{{ producto.diasCaducidad || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.ara_cen }">{{ producto.ara_cen || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.iva }">{{ producto.iva || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.precioVenta }">{{ producto.precioVenta || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.pvp_hom }">{{ producto.pvp_hom || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.pvp_and }">{{ producto.pvp_and || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.pvp_cat }">{{ producto.pvp_cat || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.precioTarifa }">{{ producto.precioTarifa || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.pro_fac }">{{ producto.pro_fac || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.precioNeto }">{{ producto.precioNeto || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.pro_ffac }">{{ producto.pro_ffac || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.pro_neton }">{{ producto.pro_neton || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.art_mkd }">{{ producto.art_mkd || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.articuloSustituido }">{{ producto.articuloSustituido || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.insertedBy }">{{ producto.insertedBy || 'Sin dato' }}</td>
              <td [ngClass]="{ 'text-danger fw-bold bg-light-danger': !producto.updateBy }">{{ producto.updateBy || 'Sin dato' }}</td>
              <td>{{ producto.status }}</td>
              <td>{{ producto.observaciones || 'Sin dato' }}</td>
              <td>{{ producto.partidaArancelaria || 'Sin dato' }}</td>
              <td>{{ producto.pvp_mel || 'Sin dato' }}</td>
              <td>{{ producto.paisOrigen || 'Sin dato' }}</td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-success" (click)="view(producto)">
                    <i class="bi bi-eye"></i>
                  </button>
                  <button class="btn btn-warning" (click)="edit(producto)">
                    <i class="bi bi-pencil-square"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <nav class="mt-3">
        <ul class="pagination justify-content-center">
          <li class="page-item" [class.disabled]="nPage <= 0">
            <a class="page-link" (click)="goToPrev()">Anterior</a>
          </li>
          <li class="page-item" *ngFor="let p of arrBotonera" [class.active]="nPage === (+p - 1)">
            <ng-container *ngIf="p === '...'; else numPage">
              <span class="page-link disabled">…</span>
            </ng-container>
            <ng-template #numPage>
              <a class="page-link" href="#" (click)="goToPage(p)">
                {{ p }}
              </a>
            </ng-template>
          </li>          
          <li class="page-item" [class.disabled]="oPage && nPage >= oPage.totalPages - 1">
            <a class="page-link" (click)="goToNext()">Siguiente</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>
